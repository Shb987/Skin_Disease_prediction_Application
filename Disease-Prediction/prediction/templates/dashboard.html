{% extends 'base.html' %}

{% block title %}Dashboard - SkinCheck AI{% endblock %}

{% block content %}
<div class="mb-10 mt-4 px-2">
  <h1 class="text-3xl font-bold text-slate-50 tracking-tight">
    Welcome back, <span class="text-indigo-400">{{ username_display }}</span>
  </h1>
  <p class="text-slate-400 mt-2">Here's your Skin Cancer detection dashboard</p>
</div>

<!-- Stats Overview -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 px-2">
  <div
    class="bg-slate-900/60 backdrop-blur-xl p-8 rounded-2xl border border-slate-800 shadow-xl group hover:border-indigo-500/50 transition-all">
    <h2 class="text-slate-500 text-sm font-medium tracking-wide uppercase">Total Scans</h2>
    <p class="text-4xl font-bold mt-2 text-slate-100 tracking-tighter">{{ stats.total_scans }}</p>
  </div>
  <div
    class="bg-slate-900/60 backdrop-blur-xl p-8 rounded-2xl border border-slate-800 shadow-xl group hover:border-emerald-500/50 transition-all">
    <h2 class="text-slate-500 text-sm font-medium tracking-wide uppercase">Normal Results</h2>
    <p class="text-4xl font-bold mt-2 text-emerald-400 tracking-tighter">{{ stats.normal_results }}</p>
  </div>
  <div
    class="bg-slate-900/60 backdrop-blur-xl p-8 rounded-2xl border border-slate-800 shadow-xl group hover:border-rose-500/50 transition-all">
    <h2 class="text-slate-500 text-sm font-medium tracking-wide uppercase">Risk Detected</h2>
    <p class="text-4xl font-bold mt-2 text-rose-400 tracking-tighter">{{ stats.risk_detected }}</p>
  </div>
</div>

<!-- Recent Scans -->
<div
  class="bg-slate-900/40 backdrop-blur-lg p-8 rounded-3xl border border-slate-800 shadow-2xl mb-10 overflow-hidden relative">
  <div class="absolute top-0 right-0 w-64 h-64 bg-indigo-500/5 blur-[100px] -z-10"></div>
  <div class="flex justify-between items-center mb-8">
    <h2 class="text-xl font-bold text-slate-100">Recent Analyses</h2>
    <a href="{% url 'upload' %}"
      class="px-5 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl text-sm font-medium transition-all shadow-lg shadow-indigo-600/20">Analyze
      New</a>
  </div>

  <div class="overflow-x-auto">
    <table class="w-full table-auto">
      <thead>
        <tr class="text-left text-slate-500 text-sm border-b border-slate-800">
          <th class="pb-4 font-semibold uppercase tracking-wider">Date</th>
          <th class="pb-4 font-semibold uppercase tracking-wider">Patient</th>
          <th class="pb-4 font-semibold uppercase tracking-wider">Type</th>
          <th class="pb-4 font-semibold uppercase tracking-wider">Result</th>
          <th class="pb-4 font-semibold uppercase tracking-wider text-right">Confidence</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-800">
        {% for scan in stats.recent_scans %}
        <tr class="group hover:bg-slate-800/30 transition-colors">
          <td class="py-5 text-slate-400 text-sm">{{ scan.timestamp|date:"Y-m-d H:i" }}</td>
          <td class="py-5 text-slate-200 font-medium">{{ scan.patient_name }}</td>
          <td class="py-5">
            <span class="px-3 py-1 bg-slate-800 text-slate-400 text-xs rounded-lg">{{ scan.scan_type }}</span>
          </td>
          <td class="py-5">
            <span class="px-3 py-1 text-xs font-semibold rounded-lg
              {% if scan.result == 'Benign' %}text-emerald-400 bg-emerald-400/10
              {% elif scan.result == 'Melanoma' %}text-rose-400 bg-rose-400/10
              {% else %}text-amber-400 bg-amber-400/10{% endif %}">
              {{ scan.result }}
            </span>
          </td>
          <td class="py-5 text-right font-mono text-indigo-400 font-bold">
            {{ scan.confidence|floatformat:2 }}%
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="py-4 text-center text-gray-500">No scans yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}